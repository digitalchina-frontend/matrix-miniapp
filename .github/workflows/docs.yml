name: Build and Deploy VuePress Site

# æ§åˆ¶å·¥ä½œæµè§¦å‘çš„æ—¶æœº
on:
  # åœ¨ç‰ˆæœ¬çŠ¶æ€ä¸º published æ—¶è¿è¡Œå·¥ä½œæµ
  release:
    types: [published]

  # å…è®¸ä» Actions tab æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ
  workflow_dispatch:

# ä¸€ä¸ªå·¥ä½œæµç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¯å¹¶è¡Œæˆ–ä¸²è¡Œæ‰§è¡Œçš„ jobs ç»„æˆ
jobs:
  # è¿™ä¸ªå·¥ä½œæµåªåŒ…å«ä¸€ä¸ªåä¸º "build-and-deploy" çš„ job
  build-and-deploy:
    # job çš„è¿è¡Œç¯å¢ƒç±»å‹
    runs-on: ubuntu-latest

    # Steps è¡¨ç¤º job ä¸­å°†è¦æ‰§è¡Œçš„ä¸€ç³»åˆ—ä»»åŠ¡
    steps:
      # åœ¨ $GITHUB_WORKSPACE ä¸‹æ£€å‡ºä»“åº“ä»£ç 
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      # æ­å»º Node ç¯å¢ƒ
      - name: Setup Node.js ğŸ”§
        uses: actions/setup-node@v3
        with:
          node-version: 16
          cache: 'npm'

      # å®‰è£…ä¾èµ–åŒ…å¹¶æ„å»º
      - name: Install and Build ğŸ”§
        run: |
          npm ci
          npm run build:docs

      # éƒ¨ç½²è‡³ master åˆ†æ”¯
      - name: Deploy ğŸš€
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: master
          build_dir: docs/.vuepress/dist
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

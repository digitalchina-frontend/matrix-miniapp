<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>定制微信小程序导航栏样式 | Matrix-小程序方向</title><meta name="description" content="大道至简，让前端开发更简单">
    <link rel="preload" href="/matrix-miniapp/assets/style-3d361ee0.css" as="style"><link rel="stylesheet" href="/matrix-miniapp/assets/style-3d361ee0.css">
    <link rel="modulepreload" href="/matrix-miniapp/assets/app-5f205ec5.js"><link rel="modulepreload" href="/matrix-miniapp/assets/framework-5866ffd3.js"><link rel="modulepreload" href="/matrix-miniapp/assets/custom-navigationbar.html-f817f80a.js"><link rel="modulepreload" href="/matrix-miniapp/assets/custom-navigationbar.html-38ec98f7.js"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-0b1d3ec9.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/best-practice.html-9b4248ce.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-dd85c0d1.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-15542f09.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-449a2c2c.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/MW001-external.html-961d004c.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/MW001-review.html-d384eca1.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/MW001.html-6871a57b.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-1959abc7.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-b809455c.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/best-practice.html-32903c97.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-6a9c8906.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-b9ee235e.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-a3f12e97.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/MW001-external.html-ca511706.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/MW001-review.html-affa8168.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/MW001.html-b3a0ebd7.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/index.html-4ab06650.js" as="script"><link rel="prefetch" href="/matrix-miniapp/assets/404.html-87d54bd8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/matrix-miniapp/" class=""><!----><span class="site-name can-hide">Matrix-小程序方向</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="微信小程序"><span class="title">微信小程序</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="微信小程序"><span class="title">微信小程序</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/matrix-miniapp/wechat/tour/" class="" aria-label="旅游业"><!--[--><!--]--> 旅游业 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/matrix-miniapp/wechat/iot/" class="" aria-label="物联网"><!--[--><!--]--> 物联网 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="uni-app"><span class="title">uni-app</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="uni-app"><span class="title">uni-app</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/matrix-miniapp/best-practice.html" class="" aria-label="小程序业务场景解决方案：一次实践演示"><!--[--><!--]--> 小程序业务场景解决方案：一次实践演示 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/digitalchina-frontend/matrix-miniapp" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="切换颜色模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="微信小程序"><span class="title">微信小程序</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="微信小程序"><span class="title">微信小程序</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/matrix-miniapp/wechat/tour/" class="" aria-label="旅游业"><!--[--><!--]--> 旅游业 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/matrix-miniapp/wechat/iot/" class="" aria-label="物联网"><!--[--><!--]--> 物联网 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="uni-app"><span class="title">uni-app</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="uni-app"><span class="title">uni-app</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/matrix-miniapp/best-practice.html" class="" aria-label="小程序业务场景解决方案：一次实践演示"><!--[--><!--]--> 小程序业务场景解决方案：一次实践演示 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/digitalchina-frontend/matrix-miniapp" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">定制微信小程序导航栏样式 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#介绍" class="router-link-active router-link-exact-active sidebar-item" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#自定义的边界" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义的边界"><!--[--><!--]--> 自定义的边界 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#如何修改胶囊按钮的配色方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何修改胶囊按钮的配色方案"><!--[--><!--]--> 如何修改胶囊按钮的配色方案 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#如何定制导航栏" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何定制导航栏"><!--[--><!--]--> 如何定制导航栏 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#第一步-隐藏默认导航栏" class="router-link-active router-link-exact-active sidebar-item" aria-label="第一步：隐藏默认导航栏"><!--[--><!--]--> 第一步：隐藏默认导航栏 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#第二步-实现一个样式和默认导航栏一致的自定义导航栏" class="router-link-active router-link-exact-active sidebar-item" aria-label="第二步：实现一个样式和默认导航栏一致的自定义导航栏"><!--[--><!--]--> 第二步：实现一个样式和默认导航栏一致的自定义导航栏 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#第三步-修改导航栏背景图片" class="router-link-active router-link-exact-active sidebar-item" aria-label="第三步：修改导航栏背景图片"><!--[--><!--]--> 第三步：修改导航栏背景图片 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#要点" class="router-link-active router-link-exact-active sidebar-item" aria-label="要点"><!--[--><!--]--> 要点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/matrix-miniapp/custom-navigationbar.html#source-·-demo" class="router-link-active router-link-exact-active sidebar-item" aria-label="Source · Demo"><!--[--><!--]--> Source · Demo <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="定制微信小程序导航栏样式" tabindex="-1"><a class="header-anchor" href="#定制微信小程序导航栏样式" aria-hidden="true">#</a> 定制微信小程序导航栏样式</h1><h2 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍" aria-hidden="true">#</a> 介绍</h2><p>为了能够吸引用户注意，突出品牌形象，设计师在设计小程序主页时往往会在导航栏位置摆放一个宣传海报或欢迎语来突出主题；为了视觉上的美观，开发者需要修改默认导航栏的背景图片或者进行更深程度的样式定制。</p><p>在 web 开发中，这一点很容易做到，但是在微信小程序里，你需要了解微信提供的可配置选项以及相应的限制。</p><p>在阅读本文档后，您将能够：</p><ul><li>通过配置隐藏默认导航栏</li><li>通过配置修改小程序菜单（胶囊按钮）的配色方案</li><li>使用微信基础 API 获取不同机型的状态栏高度</li><li>创建自定义导航栏组件以定制背景图片</li></ul><h2 id="自定义的边界" tabindex="-1"><a class="header-anchor" href="#自定义的边界" aria-hidden="true">#</a> 自定义的边界</h2><p>首先，小程序右上角的胶囊按钮的内容是不可自定义的，只能配置深色、浅色模式，官方文档是这样描述的：</p><blockquote><p>小程序的所有页面，包括小程序内嵌网页和插件，微信都会在其右上角放置官方小程序菜单（胶囊按钮），开发者不可对其内容自定义，但可选择深浅两种基本配色以适应页面设计风格。官方小程序菜单将放置在界面固定位置，开发者在设计界面时请预留出该区域空间，若需要在此区域附近放置可交互元素，要特别注意交互事件是否会冲突，操作是否容易被使用</p></blockquote><p>开发者可以控制的区域如图所示：</p><p><img src="/matrix-miniapp/images/matrix/miniapp/wx-navigation.png" alt="wx-navigation"></p><h2 id="如何修改胶囊按钮的配色方案" tabindex="-1"><a class="header-anchor" href="#如何修改胶囊按钮的配色方案" aria-hidden="true">#</a> 如何修改胶囊按钮的配色方案</h2><p>要在微信小程序中配置配色方案，你需要在根目录下的 <code>app.json</code> 中配置 <code>navigationBarTextStyle</code> 字段：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;window&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;navigationBarTextStyle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;black&quot;</span> <span class="token comment">// 仅支持 black / white</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者在页面组件的 <code>.json</code> 中配置：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;navigationBarTextStyle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;black&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>两种配置方式的区别在于，根目录下的配置对所有页面生效，页面组件下的配置仅对该页面生效，同时配置两者时，优先级为：<code>页面 &gt; 全局</code>。</p><p><code>navigationBarTextStyle</code> 字段配置的是导航栏标题颜色，微信会根据标题颜色自动使用不同的配色方案，对应关系为：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&quot;navigationBarTextStyle&quot;: &quot;black&quot; =&gt; 浅色主题
&quot;navigationBarTextStyle&quot;: &quot;white&quot; =&gt; 深色主题
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="如何定制导航栏" tabindex="-1"><a class="header-anchor" href="#如何定制导航栏" aria-hidden="true">#</a> 如何定制导航栏</h2><p>首先，导航栏本身是支持配置的，但是可配置的内容比较有限，只能满足比较简单的需求，比如：修改导航栏背景色、添加一个返回主页按钮等； 如果你想修改导航栏的背景图片或是进行更深程度的定制，就需要开发一个自定义导航栏以替换默认导航栏。</p><p>在这一小节，你将创建一个自定义导航栏组件并还原默认导航栏的样式，最后修改背景图片。</p><h3 id="第一步-隐藏默认导航栏" tabindex="-1"><a class="header-anchor" href="#第一步-隐藏默认导航栏" aria-hidden="true">#</a> 第一步：隐藏默认导航栏</h3><p>打开页面组件的 <code>.json</code> 配置文件并添加以下配置：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;navigationStyle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新编译后，默认导航栏就被隐藏了，但是你会发现页面内容和状态栏重叠到了一起，如图所示：</p><img src="/matrix-miniapp/images/matrix/miniapp/custom-navigation.png" alt="custom-navigation" style="width:200px;margin:1rem;"><h3 id="第二步-实现一个样式和默认导航栏一致的自定义导航栏" tabindex="-1"><a class="header-anchor" href="#第二步-实现一个样式和默认导航栏一致的自定义导航栏" aria-hidden="true">#</a> 第二步：实现一个样式和默认导航栏一致的自定义导航栏</h3><p>现在你需要分析默认导航栏实现的功能和特性，尝试从头开始创建一个新的导航栏，实现和默认导航栏一致的功能：</p><ul><li>固定在页面顶部</li><li>为系统状态栏留白</li><li>居中显示页面标题</li><li>在非首页、非页面栈最底层页面中展示回退按钮</li></ul><ol><li>创建一个新组件：<code>navigationBar</code>，使用以下代码作为组件模板：</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./index.wxs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>computed<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dc-navigation<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dc-navigation__content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
      <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ computed.isSubPage({ currentPages }) }}<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dc-navigation__back icon-back<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span>
      back
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    自定义导航栏
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将导航栏固定在顶部，居中显示页面标题，并为系统状态栏留白：</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.dc-navigation</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--status-bar-height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 为状态栏留白 */</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--nav-height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.dc-navigation__content</span> <span class="token punctuation">{</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.dc-navigation__back</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>系统状态栏默认为透明底，如果不给导航栏设置背景颜色，随着用户向下滚动页面，页面内容会透过状态栏显示出来，如图：</p><img src="/matrix-miniapp/images/matrix/miniapp/status-bar.png" alt="status-bar" style="width:200px;margin:1rem;"></div><ol start="2"><li>获取页面路由栈，在非首页、非页面栈最底层页面中展示回退按钮：</li></ol><p>首先获取路由栈：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">currentPages</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lifetimes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">attached</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getCurrentPages</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> currentPages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        currentPages<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">back</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 wxs 文件中根据状态 <code>currentPages</code> 计算当前页是否为子页面：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isSubPage</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> data<span class="token punctuation">.</span>currentPages<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">isSubPage</span><span class="token operator">:</span> isSubPage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p><code>getCurrentPages()</code> 是官方 API，<a href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/getCurrentPages.html" target="_blank" rel="noopener noreferrer">了解更多<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p></div><ol start="3"><li>创建一个新组件：<code>pageLayout</code>，使用以下代码作为组件模板：</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./index.wxs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>computed<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-layout<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token selector">computed.styles(</span><span class="token punctuation">{</span> statusBarHeight <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigation-bar</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于导航栏需要固定在页面顶部，已经脱离了文档流，所以我们要为布局组件添加 <code>padding-top</code>，防止页面内容被导航栏遮挡，但在这之前，我们需要获取不同机型的状态栏高度</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// pages/custom-navigationbar/components/pageLayout/index.js</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">statusBarHeight</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lifetimes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">attached</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStatusBarHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getStatusBarHeight</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">getSystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">statusBarHeight</span><span class="token operator">:</span> res<span class="token punctuation">.</span>statusBarHeight<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 wxs 将 <code>statusBarHeight</code> 转换为一个 <code>style</code> 字符串，以声明 CSS 变量：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">styles</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&#39;--status-bar-height:&#39;</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>statusBarHeight <span class="token operator">+</span> <span class="token string">&#39;px&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">styles</span><span class="token operator">:</span> styles<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>添加样式：</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.page-layout</span> <span class="token punctuation">{</span>
  <span class="token property">--nav-height</span><span class="token punctuation">:</span> 44px<span class="token punctuation">;</span> <span class="token comment">/* 微信默认导航栏高度 */</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>
    <span class="token function">var</span><span class="token punctuation">(</span>--status-bar-height<span class="token punctuation">)</span> + <span class="token function">var</span><span class="token punctuation">(</span>--nav-height<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 导航栏已经脱离文档流，为其留白 */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="第三步-修改导航栏背景图片" tabindex="-1"><a class="header-anchor" href="#第三步-修改导航栏背景图片" aria-hidden="true">#</a> 第三步：修改导航栏背景图片</h3><p>在 <code>navigationBar</code> 组件的 <code>.wxss</code> 中添加以下声明：</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.dc-navigation</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--status-bar-height<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* 为状态栏留白 */</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--nav-height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>https://636c-cloud1......<span class="token punctuation">)</span></span> 20% 0%/150rpx 100% no-repeat<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">background-origin</span><span class="token punctuation">:</span> content-box<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>恭喜，您已经完成了这一部分的学习！</p><p>花点时间回想一下你到目前为止学到了什么，挑战一下自己，凭记忆回答以下问题：</p><ul><li>如何修改胶囊按钮的配色？</li><li>如何隐藏默认导航栏？</li><li>如何为系统状态栏留白？</li><li>怎么在 CSS 中使用 JS 变量？</li></ul><h3 id="要点" tabindex="-1"><a class="header-anchor" href="#要点" aria-hidden="true">#</a> 要点</h3><ul><li>微信小程序不支持自定义胶囊按钮的内容，仅支持配置深色/浅色模式</li><li>如果想深度定制导航栏，无法仅通过配置做到，也无法继承微信的组件，只能从新开发一个以替代微信导航栏</li><li>系统状态栏和胶囊按钮会覆盖在自定义导航栏之上，定制导航栏时需要注意为其留白</li><li>系统状态栏默认为透明色，需要在其下方填充一个背景色防止页面内容透过系统状态栏显示出来</li><li>自定义导航栏通常固定在页面顶部，脱离了文档流，需要注意为其留白防止页面内容被遮挡</li></ul><h3 id="source-·-demo" tabindex="-1"><a class="header-anchor" href="#source-·-demo" aria-hidden="true">#</a> Source · Demo</h3><ul><li>Source：<a href="https://github.com/digitalchina-frontend/matrix-miniapp/tree/main/apps/wechat/miniprogram/pages/custom-navigationbar" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></li><li>Demo：<br><img src="/matrix-miniapp/images/matrix/miniapp/custom-navigationbar.jpg" alt="custom-navigationbar" style="width:200px;margin:1rem;"></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/digitalchina-frontend/matrix-miniapp/edit/main/docs/custom-navigationbar.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: zlxiao97@yahoo.com">TadXiao</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/matrix-miniapp/assets/app-5f205ec5.js" defer></script>
  </body>
</html>
